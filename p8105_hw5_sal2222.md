p8105\_hw2\_sal2222
================
Stephen Lewandowski
November 9, 2018

-   [Problem 1 - Arm longitudinal study](#problem-1---arm-longitudinal-study)

Problem 1 - Arm longitudinal study
==================================

For this problem, I will create a tidy dataframe from all participants, including the subject ID, arm, and observations over time. The raw data includes 20 files, one for each subject, each with eight weeks of observations arranged in wide format.

I made a function to read-in the spreadsheet files and transform the data in each file from wide to long by week.

I then applied the function to each file name using `map_dfr` from the `purr` package and exracted the arm and subject ID variables from the file name.

``` r
# create vector of file names to load
files <- list.files(path = "./data", pattern = "*.csv", full.names = TRUE) %>% 
  set_names()

# create function to import and transform a file
import_file <- function(filename) 
{ 
  arm_file <- read.csv(file = filename) %>% 
     gather(key = week, value = value)
} 

# map file vector over the import function and tidy tibble
arm_df <- as_tibble(
  map_dfr(.x = files, import_file, .id = "file_name") %>% 
  separate(file_name, into = c("remove_1", "remove_2", "temp_1"), sep = "/") %>%
  mutate(arm_id = str_replace(temp_1, ".csv", ""),
         week = factor(str_replace(week, "week_", ""))) %>% 
  separate(arm_id, into = c("arm", "subject_id"), sep = "_", remove = FALSE) %>% 
  select(c("arm_id", "arm", "subject_id", "week",  "value")) %>% 
  mutate(subject_id = as.integer(subject_id),
         arm_id = factor(arm_id),
         arm = factor(arm))  
)       
arm_df
```

    ## # A tibble: 160 x 5
    ##    arm_id arm   subject_id week  value
    ##    <fct>  <fct>      <int> <fct> <dbl>
    ##  1 con_01 con            1 1      0.2 
    ##  2 con_01 con            1 2     -1.31
    ##  3 con_01 con            1 3      0.66
    ##  4 con_01 con            1 4      1.96
    ##  5 con_01 con            1 5      0.23
    ##  6 con_01 con            1 6      1.09
    ##  7 con_01 con            1 7      0.05
    ##  8 con_01 con            1 8      1.94
    ##  9 con_02 con            2 1      1.13
    ## 10 con_02 con            2 2     -0.88
    ## # ... with 150 more rows

I will make a spaghetti plot showing observations on each subject over time, and to observe differences between groups.

``` r
arm_df %>%
  ggplot(aes(x = week, y = value, group = arm_id, color = arm)) +
    geom_line() + 
    labs(
      title = "Observations over time",
      x = "week",
      y = "observation value",
      caption = "Data from a longitudinal study with control arm and experimental arm"
    ) + 
    viridis::scale_color_viridis(
      name = "Arm", 
      discrete = TRUE
    )
```

<img src="p8105_hw5_sal2222_files/figure-markdown_github/arm_spaghetti_plot-1.png" width="90%" />

At the group level, experimental arm observation values were higher than control arm values. The experimental arm values increased over time, while the control arm values did not.
